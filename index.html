<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <base href="./">
  <title>ููุงุจูุงุช ุงูุตุญุฉ โ ูุณุชุดูู ุฑูุณุจูุช</title>
  <link rel="icon" type="image/svg+xml" href="./assets/favicon.svg">
  <link rel="stylesheet" href="./styles.css" />
  <style>
    /* Fallback if external CSS fails to load */
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Tahoma,Arial;background:#0b1220;color:#eaf2ff;direction:rtl}
  </style>
</head>
<body>
  <!-- INTRO SPLASH (auto hides after 4 seconds) -->
  <div id="intro-splash" class="intro-splash" aria-hidden="true">
    <div class="intro-bg"></div>
    <div class="intro-wrap">
      <div class="intro-card" role="presentation">
        <div class="intro-brand">
          <img class="intro-logo" src="./assets/intro-logo.png" alt="" />
          <div class="intro-brand-text">
            <div class="intro-title">ููุงุจูุงุช ุงูุตุญุฉ</div>
            <div class="intro-sub">ูุณุชุดูู ุฑูุณุจูุช</div>
          </div>
        </div>

        <div class="intro-doc" aria-hidden="true">
          <div class="doc-top">
            <div class="doc-dot"></div>
            <div class="doc-dot"></div>
            <div class="doc-dot"></div>
          </div>
          <div class="doc-body">
            <div class="doc-line w80"></div>
            <div class="doc-line w60"></div>
            <div class="doc-line w90"></div>
            <div class="doc-line w55"></div>
            <div class="doc-line w70"></div>
            <div class="doc-line w85"></div>
          </div>
        </div>

        <div class="intro-foot">ูุณุชูุฏ ููุงุจูุงุช</div>
      </div>
    </div>
  </div>

  <!-- SYSTEM BANNER (quota / lock messages) -->
  <div id="system-banner" class="system-banner" style="display:none;"></div>

  <!-- LOCK OVERLAY (hard limit reached) -->
  <div id="lock-overlay" class="lock-overlay" style="display:none;" aria-hidden="true"></div>

  <div id="app">
    <!-- LOGIN -->
    <section id="view-login" class="view active">
      <div class="bg"></div>
      <div class="login-card">
        <div class="brand">
          <div class="brand-icon" aria-hidden="true">
            <img src="./assets/logo.svg" alt="">
          </div>
          <div class="brand-text">
            <div class="brand-title">ููุงุจูุงุช ุงูุตุญุฉ</div>
            <div class="brand-sub">ูุณุชุดูู ุฑูุณุจูุช</div>
          </div>
        </div>

        <form id="login-form" autocomplete="on">
          <div class="field">
            <label for="login-email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input id="login-email" name="email" type="email" autocomplete="email" required />
          </div>
          <div class="field">
            <label for="login-username">ุงุณู ุงููุณุชุฎุฏู</label>
            <input id="login-username" name="username" type="text" autocomplete="username" required />
          </div>
          <div class="field">
            <label for="login-password">ูููุฉ ุงููุฑูุฑ</label>
            <input id="login-password" name="password" type="password" autocomplete="current-password" required />
          </div>
          <button class="btn primary" type="submit" id="btn-login">ุชุณุฌูู ุงูุฏุฎูู</button>
          <div class="hint" id="login-hint"></div>
        </form>
      </div>
    </section>

    <!-- SHELL -->
    <section id="view-shell" class="view">
      <header class="topbar">
        <div class="topbar-left">
          <div class="user-pill">
            <span class="dot" id="presence-dot" aria-hidden="true"></span>
            <div class="user-pill-text">
              <div class="u1" id="current-user-name">โ</div>
              <div class="u2" id="current-user-role">โ</div>
            </div>
          </div>
        </div>

        <div class="topbar-center">
          <div class="topbar-title">ููุงุจูุงุช ุงูุตุญุฉ</div>
          <div class="topbar-sub">ูุณุชุดูู ุฑูุณุจูุช</div>
        </div>

        <div class="topbar-right">
          <button class="icon-btn" id="btn-open-menu" title="ุงููุงุฆูุฉ" aria-label="ุงููุงุฆูุฉ">
            โฐ
          </button>
          <div id="mini-online" class="mini-online" title="ูุชุตู ุงูุขู" style="display:none;" aria-hidden="true"></div>
        </div>
      </header>

      <main class="main">
        <aside class="sidebar" id="sidebar">
          <button class="nav-btn" data-nav="dashboard">ููุญุฉ ุงูุชุญูู</button>
          <button class="nav-btn" data-nav="interview">ุงูููุงุจูุฉ</button>
          <button class="nav-btn" data-nav="control" data-requires="admin">ุงูุชุญูู</button>
          <button class="nav-btn" data-nav="admin" data-requires="admin">ุงูุฅุฏุงุฑุฉ</button>
          <button class="nav-btn" data-nav="audit">ูุฑุงูุจุฉ</button>
          <button class="nav-btn" data-nav="online">ุงููุชุตููู</button>
          <button class="nav-btn danger" id="btn-logout">ุชุณุฌูู ุฎุฑูุฌ</button>
        </aside>

        <section class="content">

          <!-- DASHBOARD -->
          <div class="panel active" id="panel-dashboard">
            <div class="panel-head">
              <h2>ููุญุฉ ุงูุชุญูู</h2>
              <p>ูุงุฌูุฉ ุจุณูุทุฉ ูุณุฑูุนุฉ ูุฅุฏุงุฑุฉ ุงููุฑุดุญูู ูุงููุชุงุฆุฌ.</p>
            </div>

            <div class="grid-2">
              <div class="card">
                <div class="card-title">ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ</div>
                <div class="stats">
                  <div class="stat">
                    <div class="stat-label">ุนุฏุฏ ุงููุฑุดุญูู</div>
                    <div class="stat-val" id="stat-candidates">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">ููุฏ ุงููุฑุงุฌุนุฉ</div>
                    <div class="stat-val" id="stat-review">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">ููุจูู</div>
                    <div class="stat-val" id="stat-accepted">0</div>
                  </div>
                  <div class="stat">
                    <div class="stat-label">ูุฑููุถ</div>
                    <div class="stat-val" id="stat-rejected">0</div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div class="card-title">ุจุญุซ ุณุฑูุน</div>
                <div class="field">
                  <label for="quick-search">ุงุจุญุซ ุจุงูุงุณู ุฃู ุงูุฑูู ุงููุทูู</label>
                  <input id="quick-search" type="text" placeholder="ุงูุชุจ ููุจุญุซ..." />
                </div>
                <div class="muted">ุงููุชุงุฆุฌ ุชุธูุฑ ูู ูุณู ุงูููุงุจูุฉ.</div>
              </div>
            </div>
          </div>

          <!-- INTERVIEW -->
          <div class="panel" id="panel-interview">
            <div class="panel-head">
              <div>
                <h2>ุงูููุงุจูุฉ</h2>
                <p>ุฅุถุงูุฉ ูุฑุดุญุ ุฅุฏุฎุงู ุฅุฌุงุจุงุชุ ูุชุญุฏูุซ ุงูุญุงูุฉ.</p>
              </div>
              <div class="panel-actions">
                <button class="btn primary" id="btn-fullscreen-interview">๐ฏ ููุงุจูุฉ ุฌุฏูุฏุฉ (ููุก ุงูุดุงุดุฉ)</button>
                <button class="btn primary" id="btn-add-candidate">+ ุฅุถุงูุฉ ูุฑุดุญ</button>
              </div>
            </div>

            <div class="toolbar">
              <input id="candidate-search" type="text" placeholder="ุงุจุญุซ ุจุงูุงุณู ุฃู ุงูุฑูู ุงููุทูู..." />
              <div class="spacer"></div>
              <div class="sorter">
                <label class="muted" for="candidates-sort" style="margin-inline-end:8px;">ุงูุชุฑุชูุจ</label>
                <select id="candidates-sort" class="select tiny" aria-label="ุชุฑุชูุจ ุงููุฑุดุญูู">
                  <option value="newest">ุงูุฃุญุฏุซ ุฃููุงู</option>
                  <option value="oldest">ุงูุฃูุฏู ุฃููุงู</option>
                </select>
              </div>
              <div class="pager">
                <button class="btn tiny" id="btn-prev-page">ุงูุณุงุจู</button>
                <span class="muted" id="page-indicator">1 / 1</span>
                <button class="btn tiny" id="btn-next-page">ุงูุชุงูู</button>
                <input id="page-jump" class="page-jump" type="number" min="1" step="1" placeholder="ุตูุญุฉ" />
                <button class="btn tiny" id="btn-go-page">ุงุฐูุจ</button>
              </div>
            </div>

            <div id="candidates-grid" class="cards-grid"></div>
            <div class="muted" id="candidates-empty" style="display:none;">ูุง ููุฌุฏ ูุฑุดุญูู ุจุนุฏ.</div>
            <div class="row" style="margin-top:12px; justify-content:center; gap:10px;">
              <button class="btn" id="candidates-load-more">ุนุฑุถ ุงููุฒูุฏ</button>
              <span class="muted" id="candidates-count"></span>
            </div>
          </div>

          <!-- CONTROL -->
          <div class="panel" id="panel-control">
            <div class="panel-head">
              <div>
                <h2>ุงูุชุญูู</h2>
                <p>ุฅุฏุงุฑุฉ ุฃุณุฆูุฉ ุงูููุงุจูุฉ (ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู) โ ููุฅุฏุงุฑุฉ ู Super Admin ููุท.</p>
              </div>
              <div class="panel-actions">
                <button class="btn" id="btn-link-summary">ุฑุจุท</button>
                <button class="btn primary" id="btn-add-question">+ ุฅุถุงูุฉ ุณุคุงู</button>
              </div>
            </div>

            <div id="questions-list" class="list"></div>
          </div>

          <!-- ADMIN -->
          <div class="panel" id="panel-admin">
            <div class="panel-head">
              <div>
                <h2>ุงูุฅุฏุงุฑุฉ</h2>
                <p>ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู (ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู) โ ููุฅุฏุงุฑุฉ ู Super Admin ููุท.</p>
              </div>
              <div class="panel-actions">
                <button class="btn primary" id="btn-add-user">+ ุฅุถุงูุฉ ูุณุชุฎุฏู</button>
              </div>
            </div>

            <div id="users-list" class="list"></div>
          </div>

          <!-- AUDIT -->
          <div class="panel" id="panel-audit">
            <div class="panel-head">
              <div>
                <h2>ูุฑุงูุจุฉ</h2>
                <p>ุณุฌู ูุงุถุญ ููุชุบููุฑุงุช โ ูุจุงุดุฑ (ุขุฎุฑ 200 ุญุฑูุฉ).</p>
              </div>
            </div>

            <div class="audit-filters">
              <select id="audit-filter" class="select">
                <option value="all">ุงููู</option>
                <option value="candidate">ูุฑุดุญูู</option>
                <option value="question">ุฃุณุฆูุฉ</option>
                <option value="user">ูุณุชุฎุฏููู</option>
                <option value="auth">ุฏุฎูู/ุฎุฑูุฌ</option>
              </select>
              <div class="spacer"></div>
              <div class="muted" id="presence-summary"></div>
            </div>

            <div id="audit-list" class="list"></div>
          </div>

          <!-- ONLINE -->
          <div class="panel" id="panel-online">
            <div class="panel-head">
              <div>
                <h2>ุงููุชุตููู</h2>
                <p>ุญุงูุฉ ุงููุณุชุฎุฏููู (ูุชุตู/ุบูุฑ ูุชุตู) ุฏุงุฎู ุงููููุน.</p>
              </div>
            </div>
            <div id="online-list" class="list"></div>
          </div>

        </section>
      </main>
    </section>

    <!-- MODALS -->
    <div id="modal-backdrop" class="modal-backdrop" style="display:none;">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-head">
          <div class="modal-title" id="modal-title">โ</div>
          <button class="icon-btn" id="modal-close" aria-label="ุฅุบูุงู">โ</button>
        </div>
        <div class="modal-body" id="modal-body"></div>
        <div class="modal-foot" id="modal-foot"></div>
      </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast" style="display:none;"></div>
    <!-- CONFIRM (in-app) -->
    <div id="confirm-backdrop" class="confirm-backdrop" style="display:none;" aria-hidden="true">
      <div class="confirm-modal" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
        <div class="confirm-title" id="confirm-title">ุชูุจูู</div>
        <div class="confirm-message" id="confirm-message">โ</div>
        <div class="confirm-actions">
          <button class="btn ghost" id="confirm-cancel" type="button">ุฅูุบุงุก</button>
          <button class="btn danger" id="confirm-ok" type="button">ุชุฃููุฏ</button>
        </div>
      </div>
    </div>
  </div>

  
  <!-- Firebase (Firestore) -->
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

  <script src="./intro-splash-fix.js"></script>
  <script defer src="./app.js"></script>
</body>
</html>
